ymaps.ready(["Panel"]).then(function(){var t,n=new ymaps.Map("map",{center:[56.185107,36.977631],zoom:8,controls:[]}),o=[];function e(t){return t.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")}function s(t,n){let o=0;return t.forEach(t=>{t.townshipId==n&&o++}),o}var a,i=townships,c=plots;for(a of i)for(var l of c)l.townshipId==a.id&&(t=function(n,o){var e=[];let s=0;for(let t=0;t<n.length;t++)n[t].townshipId==o&&(e[s]=(n[t].price/n[t].area).toFixed(0),s++);return Math.min(...e)}(c,l.townshipId),l=function(n,o){var e=[];let s=0;for(let t=0;t<n.length;t++)n[t].townshipId==o&&null!=n[t].priceOld&&(e[s]=(n[t].priceOld/n[t].area).toFixed(0),s++);return Math.min(...e)}(c,l.townshipId),a.minCostHundred=t,a.oldMinCostHundred=l);for(let t=0;t<townships.length;t++){var r=(r=townships[t]).oldMinCostHundred!=1/0?`<span class="content__price content__price_old">от ${e(r.oldMinCostHundred)} руб/сот.</span>`:"",p=s(plots,townships[t].id);o[t]=`<div class="content__inner" style="background: center / cover no-repeat url(assets/img/dist/townships/${townships[t].image});">
			<button type="button" class="liked content__liked"><svg width="28" height="23" viewBox="0 0 28 23" xmlns="http://www.w3.org/2000/svg" class="liked__icon"><path d="M24.3473 2.78577C23.7271 2.16522 22.9906 1.67295 22.1801 1.33709C21.3695 1.00124 20.5007 0.828369 19.6233 0.828369C18.7459 0.828369 17.8771 1.00124 17.0666 1.33709C16.256 1.67295 15.5196 2.16522 14.8993 2.78577L13.612 4.07303L12.3248 2.78577C11.0719 1.53288 9.3726 0.829019 7.60075 0.829019C5.8289 0.829019 4.12962 1.53288 2.87673 2.78577C1.62385 4.03866 0.919983 5.73794 0.919983 7.50979C0.919983 9.28164 1.62385 10.9809 2.87673 12.2338L4.164 13.5211L13.612 21.8651L23.0601 13.5211L24.3473 12.2338C24.9679 11.6135 25.4601 10.8771 25.796 10.0665C26.1319 9.25597 26.3047 8.38717 26.3047 7.50979C26.3047 6.6324 26.1319 5.7636 25.796 4.95304C25.4601 4.14248 24.9679 3.40603 24.3473 2.78577Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" /></svg></button>
			<div class="content__top">
			<h2 class="content__name">${townships[t].name}</h2>
			<div class="content__prices">
			${r}
			<span class="content__price">от <span class="content__price_big">${e(townships[t].minCostHundred)}</span> руб/сот.</span>
			</div>
			<span class="content__distance">${townships[t].distance} км. от МКАД</span>
			</div>
			</div>
			<div class="content__bottom">
			<span class="content__quantity">Участков в продаже: <b>${p}</b></span>
			<a href="town-card.html#${townships[t].id}" class="content__more button">Подробнее</a>
			</div>`}var d=new ymaps.Panel,u=(n.controls.add(d,{float:"right"}),new ymaps.GeoObjectCollection(null,{hasBalloon:!1}));for(let t=0;t<townships.length;t++)MyIconContentLayout=ymaps.templateLayoutFactory.createClass('<span class="map__label-sign"><span class="map__label-sum">$[properties.iconContentQuantity]</span>$[properties.iconContentName]</span>'),MyIconContentLayoutClick=ymaps.templateLayoutFactory.createClass('<span class="map__label-sign active"><span class="map__label-sum">$[properties.iconContentQuantity]</span>$[properties.iconContentName]</span>'),u.add(new ymaps.Placemark([townships[t].coordinates[0],townships[t].coordinates[1]],{iconContentQuantity:""+s(plots,townships[t].id),iconContentName:""+townships[t].name,balloonContent:""+o[t]},{iconLayout:"default#imageWithContent",iconImageHref:"assets/img/dist/map-ellipse.svg",iconImageSize:[18,18],iconImageOffset:[-9,-9],iconContentOffset:[-45,0],iconContentLayout:MyIconContentLayout}));n.geoObjects.add(u),u.events.add("click",function(t){var n=t.get("target");d.setContent(n.properties.get("balloonContent")),u.each(function(t){t.options.set("iconContentLayout",MyIconContentLayout)}),t.get("target").options.set("iconContentLayout",MyIconContentLayoutClick);n=($(".map__wrap").outerHeight()-$(".customControl").outerHeight())/2;$(".customControl").css("top",n)}),u.events.add("mouseenter",function(t){t.get("target").options.set("iconImageHref","assets/img/dist/map-ellipse-hover.svg")}),u.events.add("mouseleave",function(t){t.get("target").options.set("iconImageHref","assets/img/dist/map-ellipse.svg")}),$("#map").on("click",".liked",function(){$(this).parent().find(".liked__icon").toggleClass("active")}),$("#map").on("click",".closeButton",function(){u.each(function(t){t.options.set("iconContentLayout",MyIconContentLayout)})}),document.querySelectorAll("#tabs-slider-map .tab").forEach(t=>{t.addEventListener("click",()=>{document.querySelector("#tabs-slider-map .tab.active")&&document.querySelector("#tabs-slider-map .tab.active").classList.remove("active"),t.classList.add("active")})}),document.querySelector(".ymaps-2-1-79-copyright__logo").href="https://yandex.ru/legal/maps_termsofuse/?lang=ru"}),ymaps.modules.define("Panel",["util.augment","collection.Item"],function(t,n,o){function e(t){e.superclass.constructor.call(this,t)}n(e,o,{onAddToMap:function(t){e.superclass.onAddToMap.call(this,t),this.getParent().getChildElement(this).then(this._onGetChildElement,this),t.margin.addArea({top:0,left:0,width:"340px",height:"100%"})},onRemoveFromMap:function(t){this._$control&&this._$control.remove(),e.superclass.onRemoveFromMap.call(this,t)},_onGetChildElement:function(t){this._$control=$('<div class="customControl"><div class="content"></div><button type="button" class="closeButton"><svg class="closeButton-icon" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.28627 0.714294L0.714844 9.28572" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M0.714844 0.714294L9.28627 9.28572" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button></div>').appendTo(t),this._$content=$(".content"),$(".closeButton").on("click",this._onClose)},_onClose:function(){$(".customControl").css("display","none")},setContent:function(t){this._$control.css("display","flex"),this._$content.html(t)}}),t(e)});